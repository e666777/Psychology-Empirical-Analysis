# 原理：

# 定义：线性混合效应模型(linear mixed effects model) 也被称为多水平模型、层次模型、嵌套模型是一般线性模型的推广。

## 常见的使用场景：变量个体（组）间独立但个体（组）内存在相关

1、观察变量与响应变量（注：响应变量是在统计观察或实验中我们需要测量和记录的特征）并不独立。例如纵向研究中对同一个个体的多次测量，不同时期的测量往往不是相互独立的。（例如某种药物对于发烧的治疗效果的研究，每个被试在服药后半小时、一小时、半天、一天的病人体温进行观测）

2、样本的某些变量可以聚成一类（例如探究某种教学方法的效果，由于班级存在成绩的差异，可以按照班级将学生进行聚类）

## 模型解释：以教学方法为例，$Y_{ij} $表示j班级i同学的测试得分，$X_{ij} $表示该同学接受的教学方法

一般的线性回归模型为：​$Y_{ij}=β_0+β_1X_{ij}+ε_{ij}$

但是简单的线性回归模型并没有考虑到班级间的差异，在不同水平的班级可能存在差异，有可能某些班级更加适用某个教学方法

在一般线性模型的基础上加入随机效应和固定效应形成混合效应模型

Level1：$Y_{ij}=β_{0j}+β_{1j}X_{ij}+ε_{ij}$

level2：​$β_{0j}=γ_{00}+μ_{0j}$​ ; $β_{1j}=γ_{10}+μ_{1j}$​

其中

$γ_{00}$表示的是固定截距，指在所有学校中截距共有的部分，即样本平均截距。而$μ_{0j}$表示的就是学校 j 的截距与$γ_{00}$的误差。学校1的截距$β_{01}=γ_{00} + μ_{01}$

$γ_{10}$表示的是固定斜率，指在所有学校的平均斜率。而$μ_{1j}$表示的就是学校 j 的斜率与$γ_{10}$的误差，学校1的斜率$β_{11}=γ_{11} + μ_{11}$。


********************************************************************************************
# 分析流程：

1、零模型

Level1：$Y_{ij}=β_{0j}+ε_{ij}$

level2：​$β_{0j}=γ_{00}+μ_{0j}$

零模型用于描述在不增加自变量的干预下自变量的分布状况，既描述描述个体状况也描述整体状况（例如班级平均成绩、个体与所在班级均值的差异）

## 2、随机截距+固定斜率模型（随机截距模型）

Level1：​$Y_{ij}=β_{0j}+β_{1j}X_{ij}+ε_{ij}$​

level2：​​$β_{0j}=γ_{00}+μ_{0j}$​​ ; ​$β_{1j}=γ_{10}$​​

## 3、随机截距+随机斜率模型

Level1：​$Y_{ij}=β_{0j}+β_{1j}X_{ij}+ε_{ij}$​

level2：​​$β_{0j}=γ_{00}+μ_{0j}$​​ ; ​$β_{1j}=γ_{10}+μ_{1j}$​​


********************************************************************************************
相关资料：

<a href="https://mp.weixin.qq.com/s/hMsf0_2TzhtDuRFKR6aBkg">多层线性模型：原理、关键议题与R语言实现 (qq.com)</a>

语法：

![](image_1.bcaf5f1f.png)
